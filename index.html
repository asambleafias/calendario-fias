<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario Actividades FIAS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            /* Modo claro - Rojo/Burdeo como principales */
            --color-primario: #C22533;      /* Rojo principal */
            --color-secundario: #742345;    /* Burdeo secundario */
            --color-terciario: #087049;     /* Verde oscuro */
            --color-accento: #90C6BE;       /* Verde claro acento */
            
            --color-texto: #333333;
            --color-fondo: #f8f5f5;         /* Fondo ligeramente cálido */
            --color-tarjeta: #ffffff;
            --color-borde: #e6d2d5;         /* Borde rojo muy suave */
            --color-domingo: #fbe9eb;       /* Fondo domingo - rojo muy claro */
            --color-hoy: #f3e5e6;           /* Fondo hoy - rojo claro */
            --color-evento-multidias: #e6f0ed; /* Verde muy claro para eventos multidía */
        }

        [data-tema="oscuro"] {
            /* Modo oscuro - manteniendo la misma paleta pero más oscura */
            --color-primario: #D64D5A;      /* Rojo más brillante para contraste */
            --color-secundario: #8C2A55;    /* Burdeo más intenso */
            --color-terciario: #0B8A5C;     /* Verde más brillante */
            --color-accento: #9ED6CE;       /* Verde acento más claro */
            
            --color-texto: #f0e6e6;
            --color-fondo: #1a1415;         /* Fondo oscuro con tono rojizo */
            --color-tarjeta: #251d1f;
            --color-borde: #4a3a3d;
            --color-domingo: #3d2629;
            --color-hoy: #4a2d31;
            --color-evento-multidias: #24332f;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background-color: var(--color-fondo);
            color: var(--color-texto);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            padding-bottom: 2rem;
        }

        .container {
            max-width: 1400px;
        }

        header {
            background: linear-gradient(to right, var(--color-primario), var(--color-secundario));
            color: white;
            padding: 2rem 0;
            border-radius: 0 0 15px 15px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .mes-container {
            background-color: var(--color-tarjeta);
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            padding: 1.5rem;
            margin-bottom: 2.5rem;
            position: relative;
        }

        .mes-titulo {
            color: var(--color-primario);
            text-align: center;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--color-secundario);
        }

        .calendario {
            display: grid;
            grid-template-columns: repeat(7, minmax(100px, 1fr)); /* cada columna mínimo 100px */
            gap: 8px;
            position: relative;
            overflow-x: auto;   /* habilita scroll horizontal */
        }

        .calendario::-webkit-scrollbar {
            height: 8px;
        }
        .calendario::-webkit-scrollbar-thumb {
            background: var(--color-secundario);
            border-radius: 4px;
        }

        .dia-cabecera {
            text-align: center;
            font-weight: bold;
            padding: 0.5rem;
            background-color: var(--color-secundario);
            color: white;
            border-radius: 5px;
        }

        .dia {
            min-height: 120px;
            border: 1px solid var(--color-borde);
            border-radius: 6px;
            padding: 8px;
            background-color: var(--color-tarjeta);
            position: relative;
            transition: transform 0.2s;
            z-index: 1;
        }

        .dia:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .dia-numero {
            font-weight: bold;
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 1px dashed var(--color-borde);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .badge-evento {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--color-primario);
            margin-left: 4px;
        }

        .domingo {
            background-color: var(--color-domingo);
        }

        .hoy {
            background-color: var(--color-hoy);
            border: 2px solid var(--color-primario);
        }

        .actividad {
            font-size: 0.75rem;
            padding: 4px;
            margin-bottom: 4px;
            border-radius: 3px;
            background: linear-gradient(to right, var(--color-primario), var(--color-secundario));
            color: white;
            cursor: pointer;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            position: relative;
            z-index: 2;
        }

        .actividad:hover {
            opacity: 0.9;
        }

        .vacio {
            background-color: rgba(200, 200, 200, 0.2);
            border: 1px dashed var(--color-borde);
        }

        .evento-multidias {
            background-color: var(--color-evento-multidias);
            border-left: 3px solid var(--color-primario);
        }

        .evento-multidias-marcador {
            position: absolute;
            background-color: var(--color-primario);
            height: 4px;
            z-index: 0;
            opacity: 0.7;
            pointer-events: none;
        }

        .modal-content {
            background-color: var(--color-tarjeta);
            color: var(--color-texto);
        }

        .modal-header {
            border-bottom: 1px solid var(--color-borde);
        }

        .modal-footer {
            border-top: 1px solid var(--color-borde);
        }

        .navegacion-meses {
            display: flex;
            justify-content: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .btn-mes {
            background: transparent;
            border: 2px solid var(--color-primario);
            color: var(--color-primario);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            transition: all 0.3s;
        }

        .btn-mes:hover, .btn-mes.active {
            background: var(--color-primario);
            color: white;
        }

        .btn-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--color-primario);
            color: white;
            border: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        footer {
            text-align: center;
            padding: 1.5rem;
            margin-top: 2rem;
            background-color: var(--color-tarjeta);
            border-top: 1px solid var(--color-borde);
        }

        .instrucciones {
            background-color: var(--color-tarjeta);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }

        @media (max-width: 768px) {
            .dia {
                min-height: 100px;
                font-size: 0.85rem;
            }
            
            .actividad {
                font-size: 0.7rem;
                padding: 2px;
            }
        }

        .categoria-badge {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-right: 0.3rem;
            background: var(--color-secundario);
            color: white;
        }

        .modal-body a {
            color: var(--color-primario);
            text-decoration: underline;
        }

        .rango-fechas {
            font-size: 0.9em;
            color: #666;
            font-style: italic;
        }
        
        .indicador-multidia {
            position: absolute;
            bottom: 2px;
            left: 2px;
            right: 2px;
            height: 3px;
            background-color: var(--color-primario);
            border-radius: 2px;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <header>
        <div class="container text-center">
            <h1 class="display-5"><i class="fas fa-calendar-alt me-2"></i>Calendario Actividades FIAS</h1>
            <p class="lead">Septiembre - Diciembre 2025</p>
            <div class="form-check form-switch d-inline-block">
                <input class="form-check-input" type="checkbox" id="modoOscuro">
                <label class="form-check-label" for="modoOscuro">Modo oscuro</label>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="instrucciones">
            <h3><i class="fas fa-info-circle me-2"></i>Instrucciones</h3>
            <p class="mb-1">• Haz clic en cualquier actividad para ver los detalles</p>
            <p class="mb-1">• Los eventos de varios días se muestran con fondo verde claro y línea lateral</p>
            <p class="mb-1">• Una línea conecta visualmente los días de eventos prolongados</p>
            <p class="mb-1">• Usa los botones de abajo para filtrar por mes</p>
            <p class="mb-0">• Activa el modo oscuro para una visualización nocturna</p>
        </div>

        <div class="navegacion-meses" id="navegacion-meses">
            <!-- Los botones de meses se generarán con JavaScript -->
        </div>

        <div id="contenedor-meses">
            <!-- Los meses se generarán con JavaScript -->
        </div>
    </div>

    <!-- Modal para detalles de actividad -->
    <div class="modal fade" id="modalActividad" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitulo"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><strong>Fechas:</strong> <span id="modalFecha"></span></p>
                    <p><strong>Ubicación:</strong> <span id="modalUbicacion"></span></p>
                    <p><strong>Descripción:</strong> <span id="modalDescripcion"></span></p>
                    <p><strong>Categoría:</strong> <span id="modalCategoria"></span></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <button class="btn-top" id="btnScrollTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <footer>
        <p>Calendario actualizado el: <span id="fecha-actualizacion"></span></p>
        <p>© 2025 - Todos los derechos reservados</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Datos de ejemplo para el último trimestre de 2025
        const actividades = [
            { 
                id: 1, 
                fecha: "2025-09-15", 
                fechaFin: "2025-09-21",
                titulo: "Semana de receso", 
                descripcion: 'Semana de receso programada según calendario de escuela.', 
                categoria: "Actividades escuela",
                ubicacion: "--"
            },
            { 
                id: 2, 
                fecha: "2025-09-24", 
                titulo: "Asamblea", 
                descripcion: 'Asamblea post receso + informativa sobre futuras actividades.', 
                categoria: "Asambleas",
                ubicacion: "Buxef 850"
            },
            { 
                id: 3, 
                fecha: "2025-09-27", 
                titulo: "Piscinazo especialidades", 
                descripcion: "Piscinazo organizados por CCEE + CEI. Puedes comprar tu entrada en: ", 
                categoria: "Actividades CEI",
                ubicacion: "La Herradura, Isla de Maipo"
            },
            { 
                id: 4, 
                fecha: "2025-10-15", 
                titulo: "Asamblea", 
                descripcion: 'Asamblea informativa + organización semana FIAS', 
                categoria: "Asamblea",
                ubicacion: "Buxef 850"
            },
            { 
                id: 5, 
                fecha: "2025-10-20", 
                fechaFin: "2025-10-24",
                titulo: "Semana FIAS", 
                descripcion: "Este año organizaremos una semana donde los departamentos puedan mostrarse a través de charlas de docentes, post grados, tours, presentación de posters y más. ", 
                categoria: "Actividades FIAS",
                ubicacion: "Buxef 850 + Calán(?)"
            },
            { 
                id: 6, 
                fecha: "2025-10-27", 
                fechaFin: "2025-11-02", // Aquí faltaba una coma
                titulo: "Semana de Receso 2", 
                descripcion: "Semana de receso calanderizada por Escuela.", 
                categoria: "Actividades Escuela",
                ubicacion: "--"
            },
            { 
                id: 7, 
                fecha: "2025-09-01", 
                fechaFin: "2025-09-07",
                titulo: "Semana Olímpica (JOE)", 
                descripcion: 'Ven a apoyar a los deportistas de nuestra facultad! <a href="https://www.deporteazul.cl/joe/" target="_blank">Información JOEs</a>', 
                categoria: "Deportes",
                ubicacion: "Universidad de Chile"
            },
            { 
                id: 8, 
                fecha: "2025-11-05", 
                titulo: "Asamblea", 
                descripcion: "Asamblea informativa + presentación borrador oficial estatutos CEFIAS.", 
                categoria: "Asamblea",
                ubicacion: "Buxef 850"
            },
            { 
                id: 9, 
                fecha: "2025-11-21", 
                titulo: "Actividad 2 CEI", 
                descripcion: "Prontamente más información! Junten plata.", 
                categoria: "Actividades CEI",
                ubicacion: "????"
            },
            { 
                id: 10, 
                fecha: "2025-11-26", 
                titulo: "Asamblea", 
                descripcion: 'Asamblea informativa + semana pre-exámenes.', 
                categoria: "Asamblea",
                ubicacion: "Buxef 850"
            }
        ];

        // Esperar a que el DOM esté completamente cargado
        document.addEventListener('DOMContentLoaded', function() {
            // Configurar la fecha de actualización
            document.getElementById('fecha-actualizacion').textContent = new Date().toLocaleDateString('es-ES', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Inicializar el calendario
            inicializarCalendario();
            
            // Configurar el modo oscuro
            configurarModoOscuro();
            
            // Configurar el botón de scroll to top
            configurarScrollTop();
        });

        // Función para formatear fechas
        function formatearFecha(fechaStr) {
            const fecha = new Date(fechaStr);
            return fecha.toLocaleDateString('es-ES', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // Función para formatear rango de fechas
        function formatearRangoFechas(inicioStr, finStr) {
            const inicio = new Date(inicioStr);
            const fin = new Date(finStr);
            
            if (inicio.getMonth() === fin.getMonth()) {
                return `Del ${inicio.getDate()} al ${fin.getDate()} de ${inicio.toLocaleDateString('es-ES', { month: 'long' })}`;
            } else {
                return `Del ${inicio.getDate()} de ${inicio.toLocaleDateString('es-ES', { month: 'long' })} al ${fin.getDate()} de ${fin.toLocaleDateString('es-ES', { month: 'long' })}`;
            }
        }

        // Función para inicializar el calendario
        function inicializarCalendario() {
            // Crear navegación entre meses
            crearNavegacionMeses();
            
            // Mostrar todos los meses al cargar
            mostrarMeses([9, 10, 11, 12]);
        }

        // Función para crear la navegación entre meses
        function crearNavegacionMeses() {
            const navegacion = document.getElementById('navegacion-meses');
            const meses = [
                { num: 9, nombre: 'Septiembre' },
                { num: 10, nombre: 'Octubre' },
                { num: 11, nombre: 'Noviembre' },
                { num: 12, nombre: 'Diciembre' }
            ];
            
            // Botón para mostrar todos los meses
            const btnTodos = document.createElement('button');
            btnTodos.className = 'btn-mes active';
            btnTodos.textContent = 'Todos';
            btnTodos.dataset.mes = 'todos';
            btnTodos.addEventListener('click', function() {
                document.querySelectorAll('.btn-mes').forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                mostrarMeses([9, 10, 11, 12]);
            });
            navegacion.appendChild(btnTodos);
            
            // Botones para cada mes individual
            meses.forEach(mes => {
                const boton = document.createElement('button');
                boton.className = 'btn-mes';
                boton.textContent = mes.nombre;
                boton.dataset.mes = mes.num;
                boton.addEventListener('click', function() {
                    document.querySelectorAll('.btn-mes').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    mostrarMeses([mes.num]);
                });
                navegacion.appendChild(boton);
            });
        }

        // Función para mostrar meses específicos
        function mostrarMeses(mesesNumeros) {
            const contenedor = document.getElementById('contenedor-meses');
            contenedor.innerHTML = '';
            
            // Primero crear todos los meses y días
            mesesNumeros.forEach(mesNum => {
                const mesDiv = document.createElement('div');
                mesDiv.className = 'mes-container';
                mesDiv.id = `mes-${mesNum}`;
                
                const año = 2025;
                const nombreMes = new Date(año, mesNum - 1, 1).toLocaleDateString('es-ES', { month: 'long' });
                const titulo = document.createElement('h2');
                titulo.className = 'mes-titulo';
                titulo.textContent = `${nombreMes.charAt(0).toUpperCase() + nombreMes.slice(1)} ${año}`;
                mesDiv.appendChild(titulo);
                
                // Crear el calendario para este mes
                const calendarioDiv = document.createElement('div');
                calendarioDiv.className = 'calendario';
                
                // Añadir cabeceras de días
                const diasSemana = ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb', 'Dom'];
                diasSemana.forEach(dia => {
                    const diaHeader = document.createElement('div');
                    diaHeader.className = 'dia-cabecera';
                    diaHeader.textContent = dia;
                    calendarioDiv.appendChild(diaHeader);
                });
                
                // Obtener el primer día del mes y el número de días
                const primerDia = new Date(año, mesNum - 1, 1);
                const ultimoDia = new Date(año, mesNum, 0);
                const numDias = ultimoDia.getDate();
                
                // Días vacíos al inicio
                let diaInicio = primerDia.getDay();
                // Ajustar para que la semana comience en lunes (0 -> lunes, 6 -> domingo)
                diaInicio = diaInicio === 0 ? 6 : diaInicio - 1;
                
                for (let i = 0; i < diaInicio; i++) {
                    const diaVacio = document.createElement('div');
                    diaVacio.className = 'dia vacio';
                    calendarioDiv.appendChild(diaVacio);
                }
                
                // Días del mes
                const hoy = new Date();
                hoy.setHours(0, 0, 0, 0);
                
                for (let i = 1; i <= numDias; i++) {
                    const dia = new Date(año, mesNum - 1, i);
                    const diaDiv = document.createElement('div');
                    diaDiv.className = 'dia';
                    diaDiv.id = `dia-${año}-${mesNum}-${i}`;
                    
                    // Marcar domingos
                    if (dia.getDay() === 0) {
                        diaDiv.classList.add('domingo');
                    }
                    
                    // Marcar el día actual
                    if (dia.getTime() === hoy.getTime() && mesNum === hoy.getMonth() + 1 && año === hoy.getFullYear()) {
                        diaDiv.classList.add('hoy');
                    }
                    
                    const diaNumero = document.createElement('div');
                    diaNumero.className = 'dia-numero';
                    diaNumero.textContent = i;
                    diaDiv.appendChild(diaNumero);
                    
                    // Añadir actividades para este día
                    const fechaStr = `${año}-${mesNum.toString().padStart(2, '0')}-${i.toString().padStart(2, '0')}`;
                    const actividadesDia = actividades.filter(a => {
                        const fechaInicio = new Date(a.fecha);
                        const fechaFin = a.fechaFin ? new Date(a.fechaFin) : new Date(a.fecha);
                        const fechaActual = new Date(fechaStr);
                        
                        return fechaActual >= fechaInicio && fechaActual <= fechaFin;
                    });
                    
                    if (actividadesDia.length > 0) {
                        // Añadir badge indicador de eventos
                        const badge = document.createElement('span');
                        badge.className = 'badge-evento';
                        badge.title = `${actividadesDia.length} evento(s)`;
                        diaNumero.appendChild(badge);
                        
                        // Marcar como día de evento multidía
                        actividadesDia.forEach(actividad => {
                            const fechaInicio = new Date(actividad.fecha);
                            const fechaFin = actividad.fechaFin ? new Date(actividad.fechaFin) : new Date(actividad.fecha);
                            
                            if (fechaInicio.getTime() !== fechaFin.getTime()) {
                                diaDiv.classList.add('evento-multidias');
                                
                                // Añadir indicador visual en la parte inferior
                                const indicador = document.createElement('div');
                                indicador.className = 'indicador-multidia';
                                diaDiv.appendChild(indicador);
                            }
                        });
                    }
                    
                    actividadesDia.forEach(actividad => {
                        const actDiv = document.createElement('div');
                        actDiv.className = 'actividad';
                        actDiv.title = actividad.titulo;
                        actDiv.textContent = actividad.titulo;
                        actDiv.addEventListener('click', () => mostrarDetallesActividad(actividad));
                        diaDiv.appendChild(actDiv);
                    });
                    
                    calendarioDiv.appendChild(diaDiv);
                }
                
                mesDiv.appendChild(calendarioDiv);
                contenedor.appendChild(mesDiv);
            });
            
            // Ahora crear los conectores para eventos multidía
            crearConectoresEventosMultidia();
            
            // Desplazar hacia el primer mes mostrado
            if (mesesNumeros.length === 1) {
                document.getElementById(`mes-${mesesNumeros[0]}`).scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Función para crear conectores visuales entre días de eventos multidía
        function crearConectoresEventosMultidia() {
            actividades.forEach(actividad => {
                if (actividad.fechaFin && actividad.fechaFin !== actividad.fecha) {
                    const fechaInicio = new Date(actividad.fecha);
                    const fechaFin = new Date(actividad.fechaFin);
                    
                    // Solo si el evento abarca múltiples días
                    if (fechaInicio.getTime() !== fechaFin.getTime()) {
                        const mesInicio = fechaInicio.getMonth() + 1;
                        const mesFin = fechaFin.getMonth() + 1;
                        
                        // Para cada mes que abarque el evento
                        for (let mes = mesInicio; mes <= mesFin; mes++) {
                            const primerDiaMes = new Date(2025, mes - 1, 1);
                            const ultimoDiaMes = new Date(2025, mes, 0);
                            
                            const inicio = mes === mesInicio ? fechaInicio.getDate() : 1;
                            const fin = mes === mesFin ? fechaFin.getDate() : ultimoDiaMes.getDate();
                            
                            // Para cada día del evento en este mes
                            for (let dia = inicio; dia <= fin; dia++) {
                                const elementoDia = document.getElementById(`dia-2025-${mes}-${dia}`);
                                if (elementoDia) {
                                    // Ya marcamos el día con evento-multidias en la función anterior
                                    // Aquí podríamos añadir lógica adicional si es necesario
                                }
                            }
                            
                            // Crear conectores visuales entre días consecutivos
                            if (inicio < fin) {
                                for (let dia = inicio; dia < fin; dia++) {
                                    const diaActual = document.getElementById(`dia-2025-${mes}-${dia}`);
                                    const diaSiguiente = document.getElementById(`dia-2025-${mes}-${dia+1}`);
                                    
                                    if (diaActual && diaSiguiente) {
                                        // Verificar si están en la misma fila (días consecutivos)
                                        const rectActual = diaActual.getBoundingClientRect();
                                        const rectSiguiente = diaSiguiente.getBoundingClientRect();
                                        
                                        if (Math.abs(rectSiguiente.top - rectActual.top) < 5) { // Están en la misma fila
                                            const contenedor = diaActual.closest('.mes-container');
                                            const conector = document.createElement('div');
                                            conector.className = 'evento-multidias-marcador';
                                            conector.style.top = (rectActual.top + rectActual.height - 2) + 'px';
                                            conector.style.left = (rectActual.right - 4) + 'px';
                                            conector.style.width = (rectSiguiente.left - rectActual.right + 8) + 'px';
                                            
                                            contenedor.appendChild(conector);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }

        // Función para mostrar detalles de actividad en modal
        function mostrarDetallesActividad(actividad) {
            document.getElementById('modalTitulo').textContent = actividad.titulo;
            
            const fechaElement = document.getElementById('modalFecha');
            if (actividad.fechaFin && actividad.fechaFin !== actividad.fecha) {
                fechaElement.innerHTML = `<span class="rango-fechas">${formatearRangoFechas(actividad.fecha, actividad.fechaFin)}</span><br>${formatearFecha(actividad.fecha)} - ${formatearFecha(actividad.fechaFin)}`;
            } else {
                fechaElement.textContent = formatearFecha(actividad.fecha);
            }
            
            document.getElementById('modalUbicacion').textContent = actividad.ubicacion;
            document.getElementById('modalDescripcion').innerHTML = actividad.descripcion;
            
            const categoriaSpan = document.getElementById('modalCategoria');
            categoriaSpan.textContent = '';
            const badge = document.createElement('span');
            badge.className = 'categoria-badge';
            badge.textContent = actividad.categoria;
            categoriaSpan.appendChild(badge);
            
            const modal = new bootstrap.Modal(document.getElementById('modalActividad'));
            modal.show();
        }

        // Configurar el modo oscuro
        function configurarModoOscuro() {
            const toggleOscuro = document.getElementById('modoOscuro');
            const body = document.body;
            
            // Comprobar preferencia del usuario
            const prefiereOscuro = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (prefiereOscuro) {
                body.setAttribute('data-tema', 'oscuro');
                toggleOscuro.checked = true;
            }
            
            // Alternar modo oscuro al cambiar el toggle
            toggleOscuro.addEventListener('change', function() {
                if (this.checked) {
                    body.setAttribute('data-tema', 'oscuro');
                } else {
                    body.removeAttribute('data-tema');
                }
            });
        }

        // Configurar el botón de scroll to top
        function configurarScrollTop() {
            const btnScrollTop = document.getElementById('btnScrollTop');
            
            // Mostrar u ocultar el botón según la posición de scroll
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    btnScrollTop.style.display = 'block';
                } else {
                    btnScrollTop.style.display = 'none';
                }
            });
            
            // Scroll suave al hacer clic en el botón
            btnScrollTop.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        }
    </script>
</body>
</html>
